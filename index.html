<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>EdRegistry</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.3/dist/slate/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.datatables.net/1.13.8/css/dataTables.bootstrap5.min.css" rel="stylesheet">
<style>
body { padding:2rem 0; background:#272b30; }
.container-custom { max-width:94vw; margin:auto; }
.description-text { font-size:1rem; opacity:.85; line-height:1.5; background:#32383e; padding:1rem; border-radius:.5rem; box-shadow:0 4px 8px rgba(0,0,0,.3); }
.title-white { color:#fff; }
.dataTables_wrapper .dataTables_filter, .dataTables_wrapper .dataTables_length { margin-bottom:0; }
.dataTables_wrapper .row.mb-3 { display:flex; flex-wrap:nowrap; justify-content:space-between; align-items:center; }
table.dataTable th, table.dataTable td { white-space: nowrap; }
table.dataTable tbody tr:hover { background-color:#3a4f7a !important; }
.card { box-shadow:0 4px 8px rgba(0,0,0,.3); border:none; border-radius:.5rem; background:#32383e; color:#fff; }
.chart-card { display:flex; flex-direction:column; border-radius:.5rem; box-shadow:0 4px 8px rgba(0,0,0,.3); background:#32383e; color:#fff; height:100%; }
.chart-card-header { font-weight:bold; padding:.5rem 1rem; border-bottom:1px solid rgba(255,255,255,.1); }
.chart-card-body { padding:.5rem 1rem; display:flex; align-items:center; justify-content:center; }
canvas { width:200px !important; height:200px !important; }
.chart-card-footer { padding:.5rem 1rem; font-size:.8rem; color:#ccc; border-top:1px solid rgba(255,255,255,.1); text-align:center; }
.chart-card-footer span.count { font-style:italic; font-size:.7rem; color:#999; margin-left:2px; }
footer { margin-top:4rem; padding-top:1rem; border-top:1px solid #445; font-size:.9rem; opacity:.8; }
footer a { color:#fff; text-decoration:underline; }
</style>
</head>
<body>

<div class="container-custom">

<h1 class="mb-3 title-white">EdRegistry</h1>

<div class="description-text">
  EdRegistry is a dynamic, interactive registry of EdFiles used in LEGO TTGames titles.<br>
  The data displayed here is generated from GitHub sources and curated by <strong>JayFranco</strong> using a custom serializer.<br>
  Explore file types, categories, and structures with search and filtering tools.
</div>

<div class="card mt-4">
  <div class="card-body">
    <table id="datatable" class="table table-striped table-hover table-dark w-100">
      <thead></thead>
    </table>
  </div>
</div>

<div class="row g-3 mt-4" id="charts-container"></div>

<footer class="text-center mt-5">
  <p class="mb-1">Made with ❤️ by <strong>AcK</strong> & <strong>JayFranco</strong></p>
  <p class="mb-1"><a href="https://github.com/AcK77/EdRegistry" target="_blank">GitHub Repository</a></p>
  <p class="mb-0">This site is not affiliated with LEGO or TTGames. Generated in 2026.</p>
</footer>

</div>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.8/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

<script>
fetch('data/data.json')
.then(res=>res.json())
.then(data=>{
  const columnNames = Object.keys(data[0]);
  const columns = columnNames.map(k=>({ title:k,data:k }));
  const statsColumns = columnNames.slice(0,4);
  const chartsContainer = document.getElementById('charts-container');

  statsColumns.forEach(col=>{
    const counts = {};
    data.forEach(r=>{
      const v=r[col]||'(empty)';
      counts[v]=(counts[v]||0)+1;
    });
    const top = Object.entries(counts).sort((a,b)=>b[1]-a[1]);

    const chartId=`chart-${col}`;
    const chartHtml=`
      <div class="col-lg-3 col-md-6 col-12">
        <div class="chart-card">
          <div class="chart-card-header">${col}</div>
          <div class="chart-card-body"><canvas id="${chartId}"></canvas></div>
          <div class="chart-card-footer">
            ${top.slice(0,10).map(t=>`${t[0]}<span class="count">(${t[1]})</span>`).join(", ")}
          </div>
        </div>
      </div>`;
    chartsContainer.insertAdjacentHTML('beforeend',chartHtml);

    const ctx=document.getElementById(chartId).getContext('2d');
    const labels=top.slice(0,10).map(t=>t[0]);
    const dataValues=top.slice(0,10).map(t=>t[1]);
    const bgColors=['#007bff','#17a2b8','#28a745','#ffc107','#fd7e14','#6f42c1','#dc3545','#20c997','#6610f2','#e83e8c'];

    new Chart(ctx,{
      type:'pie',
      data:{labels:labels,datasets:[{data:dataValues,backgroundColor:bgColors,borderColor:'#272b30',borderWidth:1}]},
      options:{
        responsive:true,
        maintainAspectRatio:true,
        aspectRatio:1,
        plugins:{
          legend:{display:false},
          tooltip:{callbacks:{label:function(context){return context.label+": "+context.raw;}}}
        }
      }
    });
  });

  const table=$('#datatable').DataTable({
    data:data,
    columns:columns,
    pageLength:100,
    lengthMenu:[50,100,250,500],
    deferRender:true,
    scrollY:'65vh',
    scrollX:true,
    scroller:true,
    order:[],
    autoWidth:false,
    dom:"<'row mb-3'<'col-md-6'l><'col-md-6 text-end'f>>"+
        "<'row'<'col-12'tr>>"+
        "<'row mt-3'<'col-md-5'i><'col-md-7 text-end'p>>",
    language:{search:"Search:",lengthMenu:"Show _MENU_ entries",info:"Showing _START_ to _END_ of _TOTAL_ entries"}
  });
});
</script>

</body>
</html>
